<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="https://i.ibb.co/zk9hYZX/favicon-32x32.png" type="image/x-icon">
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/weebzone/weebzone/data/Surf-TG/src/ico2.png">

    <title>Batman: <!-- Filename --> </title>

    <!-- Slate Theme (Fix) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/slate/bootstrap.min.css">

    <!-- Plyr -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/weebzone/weebzone/data/Surf-TG/css/plyr.css">
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>

    <style>
        body {
            margin: 0;
        }

        .video-player {
            max-width: 55%;
            margin: auto;
            padding-bottom: 10px;
        }

        .card {
            max-width: 55%;
            margin: auto;
        }

        @media (max-width: 992px) {
            .video-player,
            .card {
                max-width: 90%;
            }
        }

        .plyr {
            border-radius: 6px;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-primary p-2">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                <img src="https://i.ibb.co/Lz7R6pCK/Picsart-25-04-22-21-49-37-806.png" height="40">
            </a>
            <form id="signoutForm" action="/logout" method="post">
                <button type="submit" class="btn btn-secondary btn-sm">
                    <i class="bi bi-box-arrow-left"></i> Logout
                </button>
            </form>
        </div>
    </nav>

    <div class="video-player">
        <!-- TV SAFE PLAYER -->
        <video id="player" controls playsinline style="width: 100%; border-radius: 6px;">
            <source src="#" type="video/mp4">
        </video>
    </div>

    <div class="card bg-secondary mb-3 p-2">
        <h6>Name: <!-- Filename --></h6>
        <p>Size: <!-- Size --></p>
    </div>

    <div class="container d-flex justify-content-center align-items-center gap-2 mb-3">
        <button onclick="mx_player()" class="btn btn-primary">MX Player</button>
        <button onclick="vlc_player()" class="btn btn-primary">VLC Mobile</button>
        <button onclick="km_player()" class="btn btn-primary">KM Player</button>
        <button onclick="get_file()" class="btn btn-info">Get File</button>
        <button onclick="copyUrl()" class="btn btn-warning">Copy Url</button>
        <button onclick="download()" class="btn btn-success">Download</button>
    </div>

    <footer class="footer text-center text-light py-3">
        <p>
            Made with ❤️ by <a href="https://t.me/batmanlinkz" target="_blank">Batman</a><br>
            © 2025 I Am Batman. All Rights Reserved.
        </p>
    </footer>

    <script>
        const videolink = window.location.href;
        const url = new URL(videolink);
        const domainUrl = url.origin;

        const videoIdWithParams = videolink.split('/').pop();
        const videoId = videoIdWithParams.split('?')[0];

        const idParam = url.searchParams.get("id");
        const hashParam = url.searchParams.get("hash");

        const encodedName = encodeURIComponent("<!-- Filename -->");

        const downloadlink = `${domainUrl}/${videoId}/${encodedName}?id=${idParam}&hash=${hashParam}`;

        // Detect Smart TVs – disable Plyr for compatibility
        const isTV =
            navigator.userAgent.includes("SMART-TV") ||
            navigator.userAgent.includes("Tizen") ||
            navigator.userAgent.includes("Web0S") ||
            navigator.userAgent.includes("NetCast") ||
            navigator.userAgent.includes("HbbTV");

        if (!isTV) {
            new Plyr("#player", {
                controls: [
                    "play", "progress", "current-time", "mute", "volume",
                    "fullscreen", "settings", "play-large", "duration"
                ],
                keyboard: { focused: true, global: true }
            });
        }

        function updateVideoSource() {
            document.getElementById("player").src = downloadlink;
        }

        window.onload = updateVideoSource;

        function mx_player() {
            window.location.href =
                `intent:${downloadlink}#Intent;package=com.mxtech.videoplayer.ad;end`;
        }

        function vlc_player() {
            window.location.href = `vlc://${downloadlink}`;
        }

        function km_player() {
            window.location.href =
                `intent:${downloadlink}#Intent;package=com.kmplayer;end`;
        }

        function download() {
            window.location.href = downloadlink;
        }

        function get_file() {
            const match = videolink.match(/(\d+)\?id=(\d+)&/);
            if (match) {
                const chatId = "-100" + match[1];
                const messageId = match[2];
                window.location.href =
                    `https://t.me/<!-- Username -->?start=file_${messageId}${chatId}`;
            }
        }

        function copyUrl() {
            navigator.clipboard.writeText(downloadlink)
                .then(() => alert("URL copied!"));
        }
    </script>

</body>
</html>
